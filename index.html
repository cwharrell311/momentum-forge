<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Momentum Forge | Stock Screener</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0b;
            --bg-secondary: #111113;
            --bg-tertiary: #1a1a1d;
            --bg-card: #141416;
            --border: #2a2a2e;
            --border-hover: #3a3a3e;
            --text-primary: #f0f0f2;
            --text-secondary: #8a8a8e;
            --text-muted: #5a5a5e;
            --accent-green: #00d4aa;
            --accent-green-dim: rgba(0, 212, 170, 0.15);
            --accent-red: #ff4757;
            --accent-red-dim: rgba(255, 71, 87, 0.15);
            --accent-blue: #4a9eff;
            --accent-blue-dim: rgba(74, 158, 255, 0.15);
            --accent-yellow: #ffc107;
            --accent-yellow-dim: rgba(255, 193, 7, 0.15);
            --accent-purple: #a855f7;
            --accent-purple-dim: rgba(168, 85, 247, 0.15);
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.5;
        }

        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 24px;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-blue) 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
            color: var(--bg-primary);
        }

        .logo-text {
            font-size: 24px;
            font-weight: 600;
            letter-spacing: -0.5px;
        }

        .logo-text span {
            color: var(--accent-green);
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .api-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            font-size: 12px;
            color: var(--text-muted);
        }

        .api-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-red);
        }

        .api-dot.connected {
            background: var(--accent-green);
        }

        .scan-btn {
            background: linear-gradient(135deg, var(--accent-green) 0%, #00b894 100%);
            color: var(--bg-primary);
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-family: 'Outfit', sans-serif;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .scan-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 20px rgba(0, 212, 170, 0.3);
        }

        .scan-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .scan-btn .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid transparent;
            border-top-color: var(--bg-primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Stats Bar */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            transition: border-color 0.2s ease;
        }

        .stat-card:hover {
            border-color: var(--border-hover);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }

        .stat-value.green { color: var(--accent-green); }
        .stat-value.blue { color: var(--accent-blue); }
        .stat-value.yellow { color: var(--accent-yellow); }
        .stat-value.purple { color: var(--accent-purple); }

        /* Filters */
        .filters-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 32px;
        }

        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .filters-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-label {
            font-size: 12px;
            color: var(--text-muted);
        }

        .filter-input {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 10px 12px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            transition: border-color 0.2s ease;
        }

        .filter-input:focus {
            outline: none;
            border-color: var(--accent-green);
        }

        .filter-input::placeholder {
            color: var(--text-muted);
        }

        select.filter-input {
            cursor: pointer;
        }

        /* Results Table */
        .results-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
        }

        .results-title {
            font-size: 16px;
            font-weight: 600;
        }

        .results-count {
            font-size: 13px;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
        }

        .table-wrapper {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            text-align: left;
            padding: 14px 20px;
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            white-space: nowrap;
        }

        td {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
            vertical-align: middle;
        }

        tr:hover td {
            background: var(--bg-tertiary);
        }

        tr:last-child td {
            border-bottom: none;
        }

        .ticker-cell {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .ticker-symbol {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            font-size: 15px;
            color: var(--accent-blue);
        }

        .company-name {
            font-size: 12px;
            color: var(--text-muted);
            max-width: 150px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .price-cell {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
        }

        .change-cell {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .change-cell.positive { color: var(--accent-green); }
        .change-cell.negative { color: var(--accent-red); }

        .signal-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .signal-badge {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            white-space: nowrap;
        }

        .signal-badge.earnings {
            background: var(--accent-green-dim);
            color: var(--accent-green);
        }

        .signal-badge.revenue {
            background: var(--accent-blue-dim);
            color: var(--accent-blue);
        }

        .signal-badge.volume {
            background: var(--accent-yellow-dim);
            color: var(--accent-yellow);
        }

        .signal-badge.options {
            background: var(--accent-purple-dim);
            color: var(--accent-purple);
        }

        .momentum-score {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .score-bar {
            width: 60px;
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            overflow: hidden;
        }

        .score-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .score-fill.high { background: var(--accent-green); }
        .score-fill.medium { background: var(--accent-yellow); }
        .score-fill.low { background: var(--accent-red); }

        .score-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            font-weight: 600;
            min-width: 28px;
        }

        .volume-cell {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
        }

        .volume-cell.spike {
            color: var(--accent-yellow);
        }

        /* Stock Detail Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 24px;
        }

        .modal-content {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 24px;
            border-bottom: 1px solid var(--border);
        }

        .modal-ticker {
            font-family: 'JetBrains Mono', monospace;
            font-size: 28px;
            font-weight: 700;
            color: var(--accent-blue);
        }

        .modal-company {
            font-size: 14px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .close-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            width: 36px;
            height: 36px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .close-btn:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .modal-body {
            padding: 24px;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .detail-item {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 16px;
        }

        .detail-label {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .detail-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 18px;
            font-weight: 600;
        }

        .signals-detail {
            margin-top: 24px;
        }

        .signals-detail h3 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .signal-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            margin-bottom: 12px;
        }

        .signal-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }

        .signal-icon.earnings { background: var(--accent-green-dim); color: var(--accent-green); }
        .signal-icon.revenue { background: var(--accent-blue-dim); color: var(--accent-blue); }
        .signal-icon.volume { background: var(--accent-yellow-dim); color: var(--accent-yellow); }
        .signal-icon.options { background: var(--accent-purple-dim); color: var(--accent-purple); }

        .signal-content h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .signal-content p {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 80px 40px;
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .empty-text {
            color: var(--text-muted);
            font-size: 14px;
        }

        /* Loading State */
        .loading-state {
            text-align: center;
            padding: 80px 40px;
        }

        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 3px solid var(--border);
            border-top-color: var(--accent-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        .loading-text {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .loading-step {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            color: var(--accent-green);
            margin-top: 8px;
        }

        .progress-bar {
            width: 200px;
            height: 4px;
            background: var(--bg-tertiary);
            border-radius: 2px;
            margin: 16px auto 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent-green);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Connection error */
        .connection-error {
            background: var(--accent-red-dim);
            border: 1px solid var(--accent-red);
            border-radius: 8px;
            padding: 16px 20px;
            margin-bottom: 24px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .connection-error-icon {
            font-size: 20px;
        }

        .connection-error-content h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent-red);
            margin-bottom: 4px;
        }

        .connection-error-content p {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .connection-error-content code {
            background: var(--bg-tertiary);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
        }

        /* View Toggle (Merriam-Webster style) */
        .view-toggle {
            display: flex;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .view-toggle-btn {
            padding: 10px 20px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            font-family: 'Outfit', sans-serif;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .view-toggle-btn.active {
            background: linear-gradient(135deg, var(--accent-green) 0%, #00b894 100%);
            color: var(--bg-primary);
        }

        .view-toggle-btn:not(.active):hover {
            color: var(--text-primary);
            background: var(--bg-secondary);
        }

        /* Congress Trade Styles */
        .trade-type-badge {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            white-space: nowrap;
        }

        .trade-type-badge.purchase {
            background: var(--accent-green-dim);
            color: var(--accent-green);
        }

        .trade-type-badge.sale {
            background: var(--accent-red-dim);
            color: var(--accent-red);
        }

        .trade-type-badge.exchange {
            background: var(--accent-blue-dim);
            color: var(--accent-blue);
        }

        .party-badge {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }

        .party-badge.democrat {
            background: rgba(74, 158, 255, 0.15);
            color: #4a9eff;
        }

        .party-badge.republican {
            background: rgba(255, 71, 87, 0.15);
            color: #ff4757;
        }

        .party-badge.independent {
            background: rgba(168, 85, 247, 0.15);
            color: #a855f7;
        }

        .chamber-badge {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 500;
            background: var(--bg-tertiary);
            color: var(--text-muted);
        }

        .disclosure-delay {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
        }

        .disclosure-delay.late {
            color: var(--accent-red);
        }

        .disclosure-delay.normal {
            color: var(--accent-yellow);
        }

        .disclosure-delay.fast {
            color: var(--accent-green);
        }

        .politician-cell {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .politician-name {
            font-weight: 600;
            font-size: 14px;
        }

        .politician-meta {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .amount-cell {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .date-cell {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app-container {
                padding: 16px;
            }

            .header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }

            .stats-bar {
                grid-template-columns: repeat(2, 1fr);
            }

            .filters-grid {
                grid-template-columns: 1fr;
            }

            th, td {
                padding: 12px 16px;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef } = React;

        // API Configuration
        const API_BASE = 'http://localhost:5000/api';

        // ==========================================
        // Congress Tracker View
        // ==========================================
        function CongressView({ apiConnected, loading, refreshTrigger }) {
            const [trades, setTrades] = useState([]);
            const [stats, setStats] = useState(null);
            const [dataSource, setDataSource] = useState(null);
            const [sourceErrors, setSourceErrors] = useState([]);
            const [congressFilters, setCongressFilters] = useState({
                chamber: 'all',
                party: 'all',
                trade_type: 'all',
                ticker: '',
                politician: ''
            });

            const fetchTrades = useCallback(async () => {
                try {
                    const params = new URLSearchParams();
                    if (congressFilters.chamber !== 'all') params.set('chamber', congressFilters.chamber);
                    if (congressFilters.party !== 'all') params.set('party', congressFilters.party);
                    if (congressFilters.trade_type !== 'all') params.set('trade_type', congressFilters.trade_type);
                    if (congressFilters.ticker) params.set('ticker', congressFilters.ticker);
                    if (congressFilters.politician) params.set('politician', congressFilters.politician);

                    const response = await fetch(`${API_BASE}/congress/trades?${params}`);
                    if (response.ok) {
                        const data = await response.json();
                        setTrades(data.trades || []);
                        setDataSource(data.data_source || null);
                        setSourceErrors(data.source_errors || []);
                    }
                } catch (e) {
                    console.error('Failed to fetch congress trades:', e);
                }
            }, [congressFilters]);

            const fetchStats = useCallback(async () => {
                try {
                    const response = await fetch(`${API_BASE}/congress/stats`);
                    if (response.ok) {
                        const data = await response.json();
                        setStats(data);
                    }
                } catch (e) {
                    console.error('Failed to fetch congress stats:', e);
                }
            }, []);

            // Fetch on mount and when filters change
            useEffect(() => {
                if (apiConnected) {
                    fetchTrades();
                    fetchStats();
                }
            }, [apiConnected, fetchTrades, fetchStats]);

            // Re-fetch when refresh completes (refreshTrigger increments)
            useEffect(() => {
                if (refreshTrigger > 0 && apiConnected) {
                    fetchTrades();
                    fetchStats();
                }
            }, [refreshTrigger]);

            const getDelayClass = (days) => {
                if (days > 45) return 'late';
                if (days > 20) return 'normal';
                return 'fast';
            };

            const getPartyClass = (party) => {
                if (party.toLowerCase().includes('democrat')) return 'democrat';
                if (party.toLowerCase().includes('republican')) return 'republican';
                return 'independent';
            };

            const getTradeTypeClass = (type) => {
                if (type.includes('Purchase')) return 'purchase';
                if (type.includes('Sale')) return 'sale';
                return 'exchange';
            };

            return (
                <div>
                    {/* Data Source Indicator */}
                    {dataSource && (
                        <div style={{
                            marginBottom: '16px',
                            padding: '12px 16px',
                            background: dataSource.includes('failed') || dataSource.includes('NONE')
                                ? 'var(--accent-red-dim)'
                                : 'var(--accent-green-dim)',
                            border: '1px solid ' + (dataSource.includes('failed') || dataSource.includes('NONE')
                                ? 'var(--accent-red)'
                                : 'var(--accent-green)'),
                            borderRadius: '8px',
                            fontSize: '13px'
                        }}>
                            <strong>Data Source:</strong> {dataSource}
                            {stats?.newest_trade_date && (
                                <span style={{marginLeft: '16px', color: 'var(--text-secondary)'}}>
                                    Newest trade: {stats.newest_trade_date}
                                </span>
                            )}
                        </div>
                    )}

                    {/* Error Messages */}
                    {sourceErrors && sourceErrors.length > 0 && trades.length === 0 && (
                        <div style={{
                            marginBottom: '16px',
                            padding: '12px 16px',
                            background: 'var(--accent-yellow-dim)',
                            border: '1px solid var(--accent-yellow)',
                            borderRadius: '8px',
                            fontSize: '13px'
                        }}>
                            <strong style={{display: 'block', marginBottom: '8px'}}>Data source issues:</strong>
                            <ul style={{marginLeft: '20px', lineHeight: '1.6'}}>
                                {sourceErrors.slice(0, 5).map((err, i) => (
                                    <li key={i}>{err}</li>
                                ))}
                            </ul>
                            <div style={{marginTop: '12px', color: 'var(--text-secondary)'}}>
                                <strong>To fix:</strong> Get a free Finnhub API key at{' '}
                                <a href="https://finnhub.io/register" target="_blank" style={{color: 'var(--accent-blue)'}}>finnhub.io/register</a>
                                {' '}then set: <code style={{background: 'var(--bg-tertiary)', padding: '2px 6px', borderRadius: '4px'}}>export FINNHUB_API_KEY=your_key</code>
                            </div>
                        </div>
                    )}

                    <div className="stats-bar">
                        <div className="stat-card">
                            <div className="stat-label">Total Trades</div>
                            <div className="stat-value blue">{stats?.total_trades || '‚Äî'}</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">Purchases</div>
                            <div className="stat-value green">{stats?.total_purchases || '‚Äî'}</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">Sales</div>
                            <div className="stat-value" style={{color: 'var(--accent-red)'}}>{stats?.total_sales || '‚Äî'}</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">Avg Days to Disclose</div>
                            <div className="stat-value yellow">{stats?.avg_days_to_disclose || '‚Äî'}</div>
                        </div>
                    </div>

                    <div className="filters-section">
                        <div className="filters-header">
                            <div className="filters-title">Filters</div>
                        </div>
                        <div className="filters-grid">
                            <div className="filter-group">
                                <label className="filter-label">Chamber</label>
                                <select className="filter-input" value={congressFilters.chamber}
                                    onChange={e => setCongressFilters(p => ({...p, chamber: e.target.value}))}>
                                    <option value="all">All</option>
                                    <option value="Senate">Senate</option>
                                    <option value="House">House</option>
                                </select>
                            </div>
                            <div className="filter-group">
                                <label className="filter-label">Party</label>
                                <select className="filter-input" value={congressFilters.party}
                                    onChange={e => setCongressFilters(p => ({...p, party: e.target.value}))}>
                                    <option value="all">All Parties</option>
                                    <option value="Democrat">Democrat</option>
                                    <option value="Republican">Republican</option>
                                    <option value="Independent">Independent</option>
                                </select>
                            </div>
                            <div className="filter-group">
                                <label className="filter-label">Trade Type</label>
                                <select className="filter-input" value={congressFilters.trade_type}
                                    onChange={e => setCongressFilters(p => ({...p, trade_type: e.target.value}))}>
                                    <option value="all">All Types</option>
                                    <option value="Purchase">Purchases</option>
                                    <option value="Sale">Sales</option>
                                </select>
                            </div>
                            <div className="filter-group">
                                <label className="filter-label">Search Ticker</label>
                                <input type="text" className="filter-input" placeholder="e.g. AAPL"
                                    value={congressFilters.ticker}
                                    onChange={e => setCongressFilters(p => ({...p, ticker: e.target.value.toUpperCase()}))} />
                            </div>
                            <div className="filter-group">
                                <label className="filter-label">Search Politician</label>
                                <input type="text" className="filter-input" placeholder="e.g. Pelosi"
                                    value={congressFilters.politician}
                                    onChange={e => setCongressFilters(p => ({...p, politician: e.target.value}))} />
                            </div>
                        </div>
                    </div>

                    <div className="results-section">
                        <div className="results-header">
                            <div className="results-title">Congressional Trades</div>
                            <div className="results-count">{trades.length} trades</div>
                        </div>

                        {loading ? (
                            <div className="loading-state">
                                <div className="loading-spinner"></div>
                                <div className="loading-text">Fetching congressional trade data...</div>
                            </div>
                        ) : trades.length === 0 ? (
                            <div className="empty-state">
                                <div className="empty-icon">üèõÔ∏è</div>
                                <div className="empty-title">No trades loaded</div>
                                <div className="empty-text">
                                    {apiConnected
                                        ? 'Click "Run Scan" to fetch congressional trades'
                                        : 'Connect the backend to start tracking'}
                                </div>
                            </div>
                        ) : (
                            <div className="table-wrapper">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Politician</th>
                                            <th>Ticker</th>
                                            <th>Type</th>
                                            <th>Amount</th>
                                            <th>Trade Date</th>
                                            <th>Disclosed</th>
                                            <th>Delay</th>
                                            <th>Owner</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {trades.map((trade, i) => (
                                            <tr key={i}>
                                                <td>
                                                    <div className="politician-cell">
                                                        <span className="politician-name">{trade.politician}</span>
                                                        <div className="politician-meta">
                                                            <span className={`party-badge ${getPartyClass(trade.party)}`}>{trade.party}</span>
                                                            <span className="chamber-badge">{trade.chamber}</span>
                                                            {trade.state && <span className="chamber-badge">{trade.state}</span>}
                                                        </div>
                                                    </div>
                                                </td>
                                                <td><span className="ticker-symbol">{trade.ticker}</span></td>
                                                <td><span className={`trade-type-badge ${getTradeTypeClass(trade.trade_type)}`}>{trade.trade_type}</span></td>
                                                <td><span className="amount-cell">{trade.amount_range}</span></td>
                                                <td><span className="date-cell">{trade.trade_date}</span></td>
                                                <td><span className="date-cell">{trade.disclosure_date}</span></td>
                                                <td><span className={`disclosure-delay ${getDelayClass(trade.days_to_disclose)}`}>{trade.days_to_disclose}d</span></td>
                                                <td style={{fontSize: '12px', color: 'var(--text-muted)'}}>{trade.owner}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // ==========================================
        // Main App
        // ==========================================
        function App() {
            const [activeView, setActiveView] = useState('momentum');
            const [stocks, setStocks] = useState([]);
            const [filteredStocks, setFilteredStocks] = useState([]);
            const [loading, setLoading] = useState(false);
            const [loadingMessage, setLoadingMessage] = useState('');
            const [loadingProgress, setLoadingProgress] = useState(0);
            const [selectedStock, setSelectedStock] = useState(null);
            const [apiConnected, setApiConnected] = useState(false);
            const [stats, setStats] = useState(null);
            const [congressLoading, setCongressLoading] = useState(false);
            const [congressRefreshTrigger, setCongressRefreshTrigger] = useState(0);
            const congressViewRef = useRef(null);
            const [filters, setFilters] = useState({
                minMarketCap: 1,
                minMomentum: 0,
                sector: 'all',
                signal: 'all'
            });
            
            const pollInterval = useRef(null);
            const scanningRef = useRef(false);

            // Check API connection
            const checkConnection = useCallback(async () => {
                try {
                    const response = await fetch(`${API_BASE}/health`);
                    if (response.ok) {
                        setApiConnected(true);
                        return true;
                    }
                } catch (e) {
                    setApiConnected(false);
                }
                return false;
            }, []);

            // Fetch stats
            const fetchStats = useCallback(async () => {
                try {
                    const response = await fetch(`${API_BASE}/stats`);
                    if (response.ok) {
                        const data = await response.json();
                        setStats(data);
                    }
                } catch (e) {
                    console.error('Failed to fetch stats:', e);
                }
            }, []);

            // Fetch results
            const fetchResults = useCallback(async () => {
                try {
                    const response = await fetch(`${API_BASE}/results`);
                    if (response.ok) {
                        const data = await response.json();
                        setStocks(data.results);
                        setFilteredStocks(data.results);
                    }
                } catch (e) {
                    console.error('Failed to fetch results:', e);
                }
            }, []);

            // Poll scan status
            const pollStatus = useCallback(async () => {
                try {
                    const response = await fetch(`${API_BASE}/status`);
                    if (response.ok) {
                        const status = await response.json();
                        setLoadingMessage(status.message);
                        setLoadingProgress(status.progress);

                        if (!status.running && scanningRef.current) {
                            scanningRef.current = false;
                            setLoading(false);
                            clearInterval(pollInterval.current);
                            await fetchResults();
                            await fetchStats();
                        }
                    }
                } catch (e) {
                    console.error('Failed to poll status:', e);
                }
            }, [fetchResults, fetchStats]);

            // Start scan
            const runScan = async () => {
                const connected = await checkConnection();
                if (!connected) {
                    alert('Cannot connect to backend. Make sure the server is running.');
                    return;
                }

                setLoading(true);
                scanningRef.current = true;
                setLoadingProgress(0);
                setLoadingMessage('Starting scan...');
                setStocks([]);

                try {
                    const response = await fetch(`${API_BASE}/scan`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ min_market_cap: filters.minMarketCap })
                    });

                    if (response.ok) {
                        // Start polling for status
                        pollInterval.current = setInterval(pollStatus, 1000);
                    } else {
                        setLoading(false);
                        scanningRef.current = false;
                        alert('Failed to start scan');
                    }
                } catch (e) {
                    setLoading(false);
                    scanningRef.current = false;
                    alert('Failed to connect to backend');
                }
            };

            // Refresh congress data (triggered by Run Scan button on congress view)
            const refreshCongress = async () => {
                const connected = await checkConnection();
                if (!connected) {
                    alert('Cannot connect to backend. Make sure the server is running.');
                    return;
                }

                setCongressLoading(true);
                try {
                    await fetch(`${API_BASE}/congress/refresh`, { method: 'POST' });
                    const poll = setInterval(async () => {
                        const res = await fetch(`${API_BASE}/congress/status`);
                        if (res.ok) {
                            const status = await res.json();
                            if (!status.loading) {
                                clearInterval(poll);
                                setCongressLoading(false);
                                setCongressRefreshTrigger(prev => prev + 1);
                            }
                        }
                    }, 1000);
                } catch (e) {
                    setCongressLoading(false);
                }
            };

            // Initial connection check
            useEffect(() => {
                checkConnection();
                const interval = setInterval(checkConnection, 10000);
                return () => clearInterval(interval);
            }, [checkConnection]);

            // Load existing results on mount
            useEffect(() => {
                if (apiConnected) {
                    fetchResults();
                    fetchStats();
                }
            }, [apiConnected, fetchResults, fetchStats]);

            // Apply filters
            useEffect(() => {
                let result = [...stocks];

                if (filters.minMarketCap > 0) {
                    result = result.filter(s => s.market_cap_b >= filters.minMarketCap);
                }

                if (filters.minMomentum > 0) {
                    result = result.filter(s => s.momentum_score >= filters.minMomentum);
                }

                if (filters.sector !== 'all') {
                    result = result.filter(s => s.sector === filters.sector);
                }

                if (filters.signal !== 'all') {
                    result = result.filter(s => s.signals && s.signals.includes(filters.signal));
                }

                setFilteredStocks(result);
            }, [filters, stocks]);

            const handleFilterChange = (key, value) => {
                setFilters(prev => ({ ...prev, [key]: value }));
            };

            const getScoreClass = (score) => {
                if (score >= 60) return 'high';
                if (score >= 60) return 'medium';
                return 'low';
            };

            const formatMarketCap = (cap) => {
                if (cap >= 1000) return `$${(cap / 1000).toFixed(1)}T`;
                return `$${cap.toFixed(1)}B`;
            };

            const uniqueSectors = [...new Set(stocks.map(s => s.sector).filter(Boolean))];
            const signalTypes = ['earnings', 'revenue', 'volume', 'options'];

            return (
                <div className="app-container">
                    <header className="header">
                        <div className="logo">
                            <div className="logo-icon">M</div>
                            <div className="logo-text">Momentum<span>Forge</span></div>
                        </div>
                        <div className="view-toggle">
                            <button className={`view-toggle-btn ${activeView === 'momentum' ? 'active' : ''}`}
                                onClick={() => setActiveView('momentum')}>
                                Momentum Screener
                            </button>
                            <button className={`view-toggle-btn ${activeView === 'congress' ? 'active' : ''}`}
                                onClick={() => setActiveView('congress')}>
                                Capitol Tracker
                            </button>
                        </div>
                        <div className="header-actions">
                            <div className="api-status">
                                <div className={`api-dot ${apiConnected ? 'connected' : ''}`}></div>
                                {apiConnected ? 'Backend Connected' : 'Backend Offline'}
                            </div>
                            <button className="scan-btn" onClick={() => activeView === 'momentum' ? runScan() : refreshCongress()} disabled={loading || congressLoading || !apiConnected}>
                                {(loading || congressLoading) ? (
                                    <>
                                        <div className="spinner"></div>
                                        {activeView === 'momentum' ? 'Scanning...' : 'Loading...'}
                                    </>
                                ) : (
                                    <>
                                        ‚ö° {activeView === 'momentum' ? 'Run Scan' : 'Run Scan'}
                                    </>
                                )}
                            </button>
                        </div>
                    </header>

                    {!apiConnected && (
                        <div className="connection-error">
                            <div className="connection-error-icon">‚ö†Ô∏è</div>
                            <div className="connection-error-content">
                                <h4>Backend Not Connected</h4>
                                <p>
                                    Start the backend server to enable live scanning. Run these commands in your terminal:
                                    <br /><br />
                                    <code>pip install -r requirements.txt</code>
                                    <br />
                                    <code>python server.py</code>
                                </p>
                            </div>
                        </div>
                    )}

                    {activeView === 'congress' && <CongressView apiConnected={apiConnected} loading={congressLoading} refreshTrigger={congressRefreshTrigger} />}

                    {activeView === 'momentum' && (
                        <div>
                    <div className="stats-bar">
                        <div className="stat-card">
                            <div className="stat-label">Stocks Scanned</div>
                            <div className="stat-value blue">{stats?.total_scanned || '‚Äî'}</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">Signals Found</div>
                            <div className="stat-value green">{stats?.signals_found || filteredStocks.length || '‚Äî'}</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">High Conviction (60+)</div>
                            <div className="stat-value yellow">{stats?.high_conviction || filteredStocks.filter(s => s.momentum_score >= 60).length || '‚Äî'}</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">Bullish Options Flow</div>
                            <div className="stat-value purple">{stats?.bullish_options_flow || filteredStocks.filter(s => s.unusual_options_activity).length || '‚Äî'}</div>
                        </div>
                    </div>

                    <div className="filters-section">
                        <div className="filters-header">
                            <div className="filters-title">Filters</div>
                        </div>
                        <div className="filters-grid">
                            <div className="filter-group">
                                <label className="filter-label">Min Market Cap ($B)</label>
                                <input
                                    type="number"
                                    className="filter-input"
                                    value={filters.minMarketCap}
                                    onChange={(e) => handleFilterChange('minMarketCap', parseFloat(e.target.value) || 0)}
                                    placeholder="1"
                                />
                            </div>
                            <div className="filter-group">
                                <label className="filter-label">Min Momentum Score</label>
                                <input
                                    type="number"
                                    className="filter-input"
                                    value={filters.minMomentum}
                                    onChange={(e) => handleFilterChange('minMomentum', parseFloat(e.target.value) || 0)}
                                    placeholder="0"
                                    min="0"
                                    max="100"
                                />
                            </div>
                            <div className="filter-group">
                                <label className="filter-label">Sector</label>
                                <select
                                    className="filter-input"
                                    value={filters.sector}
                                    onChange={(e) => handleFilterChange('sector', e.target.value)}
                                >
                                    <option value="all">All Sectors</option>
                                    {uniqueSectors.map(sector => (
                                        <option key={sector} value={sector}>{sector}</option>
                                    ))}
                                </select>
                            </div>
                            <div className="filter-group">
                                <label className="filter-label">Signal Type</label>
                                <select
                                    className="filter-input"
                                    value={filters.signal}
                                    onChange={(e) => handleFilterChange('signal', e.target.value)}
                                >
                                    <option value="all">All Signals</option>
                                    {signalTypes.map(signal => (
                                        <option key={signal} value={signal}>{signal.charAt(0).toUpperCase() + signal.slice(1)}</option>
                                    ))}
                                </select>
                            </div>
                        </div>
                    </div>

                    <div className="results-section">
                        <div className="results-header">
                            <div className="results-title">Momentum Watchlist</div>
                            <div className="results-count">{filteredStocks.length} stocks</div>
                        </div>

                        {loading ? (
                            <div className="loading-state">
                                <div className="loading-spinner"></div>
                                <div className="loading-text">Analyzing market data...</div>
                                <div className="loading-step">{loadingMessage}</div>
                                <div className="progress-bar">
                                    <div className="progress-fill" style={{ width: `${loadingProgress}%` }}></div>
                                </div>
                            </div>
                        ) : stocks.length === 0 ? (
                            <div className="empty-state">
                                <div className="empty-icon">üìä</div>
                                <div className="empty-title">Ready to scan</div>
                                <div className="empty-text">
                                    {apiConnected 
                                        ? 'Click "Run Scan" to find momentum stocks'
                                        : 'Connect the backend to start scanning'}
                                </div>
                            </div>
                        ) : (
                            <div className="table-wrapper">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Ticker</th>
                                            <th>Price</th>
                                            <th>Change</th>
                                            <th>Market Cap</th>
                                            <th>Volume</th>
                                            <th>Earnings</th>
                                            <th>Revenue</th>
                                            <th>Upside</th>
                                            <th>Momentum</th>
                                            <th>Options Flow</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {filteredStocks.map(stock => (
                                            <tr key={stock.ticker} onClick={() => setSelectedStock(stock)} style={{ cursor: 'pointer' }}>
                                                <td>
                                                    <div className="ticker-cell">
                                                        <div>
                                                            <div className="ticker-symbol">{stock.ticker}</div>
                                                            <div className="company-name">{stock.name}</div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td className="price-cell">${stock.price?.toFixed(2)}</td>
                                                <td>
                                                    <div className={`change-cell ${stock.change_percent >= 0 ? 'positive' : 'negative'}`}>
                                                        {stock.change_percent >= 0 ? '‚ñ≤' : '‚ñº'} {Math.abs(stock.change_percent || 0).toFixed(1)}%
                                                    </div>
                                                </td>
                                                <td>{formatMarketCap(stock.market_cap_b)}</td>
                                                <td>
                                                    <span className={`volume-cell ${stock.volume_spike_pct >= 150 ? 'spike' : ''}`}>
                                                        {stock.volume_spike_pct?.toFixed(0)}%
                                                    </span>
                                                </td>
                                                <td>
                                                    <span className={stock.earnings_surprise_pct > 0 ? 'positive' : stock.earnings_surprise_pct < 0 ? 'negative' : ''}>
                                                        {stock.earnings_surprise_pct != null ? `${stock.earnings_surprise_pct > 0 ? '+' : ''}${stock.earnings_surprise_pct.toFixed(1)}%` : '-'}
                                                    </span>
                                                </td>
                                                <td>
                                                    <span className={stock.revenue_growth_yoy > 0 ? 'positive' : stock.revenue_growth_yoy < 0 ? 'negative' : ''}>
                                                        {stock.revenue_growth_yoy != null ? `${stock.revenue_growth_yoy > 0 ? '+' : ''}${stock.revenue_growth_yoy.toFixed(1)}%` : '-'}
                                                    </span>
                                                </td>
                                                <td>
                                                    <span className={stock.analyst_upside_pct > 0 ? 'positive' : stock.analyst_upside_pct < 0 ? 'negative' : ''}>
                                                        {stock.analyst_upside_pct != null ? `${stock.analyst_upside_pct > 0 ? '+' : ''}${stock.analyst_upside_pct.toFixed(1)}%` : '-'}
                                                    </span>
                                                </td>
                                                <td>
                                                    <div className="momentum-score">
                                                        <div className="score-bar">
                                                            <div 
                                                                className={`score-fill ${getScoreClass(stock.momentum_score)}`}
                                                                style={{ width: `${stock.momentum_score}%` }}
                                                            ></div>
                                                        </div>
                                                        <span className="score-value">{stock.momentum_score}</span>
                                                    </div>
                                                </td>
                                                <td style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>
                                                    {stock.options_flow_description}
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        )}
                    </div>
                        </div>
                    )}

                    {selectedStock && (
                        <div className="modal-overlay" onClick={() => setSelectedStock(null)}>
                            <div className="modal-content" onClick={e => e.stopPropagation()}>
                                <div className="modal-header">
                                    <div>
                                        <div className="modal-ticker">{selectedStock.ticker}</div>
                                        <div className="modal-company">{selectedStock.name}</div>
                                    </div>
                                    <button className="close-btn" onClick={() => setSelectedStock(null)}>‚úï</button>
                                </div>
                                <div className="modal-body">
                                    <div className="detail-grid">
                                        <div className="detail-item">
                                            <div className="detail-label">Price</div>
                                            <div className="detail-value">${selectedStock.price?.toFixed(2)}</div>
                                        </div>
                                        <div className="detail-item">
                                            <div className="detail-label">Market Cap</div>
                                            <div className="detail-value">{formatMarketCap(selectedStock.market_cap_b)}</div>
                                        </div>
                                        <div className="detail-item">
                                            <div className="detail-label">Momentum Score</div>
                                            <div className="detail-value" style={{ color: 'var(--accent-green)' }}>{selectedStock.momentum_score}/100</div>
                                        </div>
                                        <div className="detail-item">
                                            <div className="detail-label">Sector</div>
                                            <div className="detail-value">{selectedStock.sector}</div>
                                        </div>
                                    </div>

                                    <div className="detail-grid">
                                        <div className="detail-item">
                                            <div className="detail-label">Above 20 MA</div>
                                            <div className="detail-value">{selectedStock.above_ma20 ? '‚úì Yes' : '‚úó No'}</div>
                                        </div>
                                        <div className="detail-item">
                                            <div className="detail-label">Above 50 MA</div>
                                            <div className="detail-value">{selectedStock.above_ma50 ? '‚úì Yes' : '‚úó No'}</div>
                                        </div>
                                        <div className="detail-item">
                                            <div className="detail-label">Above 200 MA</div>
                                            <div className="detail-value">{selectedStock.above_ma200 ? '‚úì Yes' : '‚úó No'}</div>
                                        </div>
                                        <div className="detail-item">
                                            <div className="detail-label">Volume vs Avg</div>
                                            <div className="detail-value" style={{ color: selectedStock.volume_spike_pct >= 150 ? 'var(--accent-yellow)' : 'inherit' }}>
                                                {selectedStock.volume_spike_pct?.toFixed(0)}%
                                            </div>
                                        </div>
                                    </div>

                                    <div className="detail-grid">
                                        <div className="detail-item">
                                            <div className="detail-label">Earnings Surprise</div>
                                            <div className="detail-value" style={{ color: selectedStock.earnings_surprise_pct > 0 ? 'var(--accent-green)' : selectedStock.earnings_surprise_pct < 0 ? 'var(--accent-red)' : 'inherit' }}>
                                                {selectedStock.earnings_surprise_pct != null ? `${selectedStock.earnings_surprise_pct > 0 ? '+' : ''}${selectedStock.earnings_surprise_pct}%` : '-'}
                                            </div>
                                        </div>
                                        <div className="detail-item">
                                            <div className="detail-label">Revenue Growth</div>
                                            <div className="detail-value" style={{ color: selectedStock.revenue_growth_yoy > 0 ? 'var(--accent-green)' : selectedStock.revenue_growth_yoy < 0 ? 'var(--accent-red)' : 'inherit' }}>
                                                {selectedStock.revenue_growth_yoy != null ? `${selectedStock.revenue_growth_yoy > 0 ? '+' : ''}${selectedStock.revenue_growth_yoy}% YoY` : '-'}
                                            </div>
                                        </div>
                                        <div className="detail-item">
                                            <div className="detail-label">Target Price</div>
                                            <div className="detail-value">
                                                {selectedStock.target_price != null ? `$${selectedStock.target_price.toFixed(2)}` : '-'}
                                            </div>
                                        </div>
                                        <div className="detail-item">
                                            <div className="detail-label">Analyst Upside</div>
                                            <div className="detail-value" style={{ color: selectedStock.analyst_upside_pct > 0 ? 'var(--accent-green)' : selectedStock.analyst_upside_pct < 0 ? 'var(--accent-red)' : 'inherit' }}>
                                                {selectedStock.analyst_upside_pct != null ? `${selectedStock.analyst_upside_pct > 0 ? '+' : ''}${selectedStock.analyst_upside_pct}%` : '-'}
                                            </div>
                                        </div>
                                    </div>

                                    <div className="signals-detail">
                                        <h3>Signal Breakdown</h3>
                                        
                                        {selectedStock.signals?.includes('earnings') && (
                                            <div className="signal-item">
                                                <div className="signal-icon earnings">üìà</div>
                                                <div className="signal-content">
                                                    <h4>Earnings Surprise: {selectedStock.earnings_surprise_pct ? `+${selectedStock.earnings_surprise_pct}%` : 'Detected'}</h4>
                                                    <p>Beat analyst estimates, signaling stronger-than-expected business performance.</p>
                                                </div>
                                            </div>
                                        )}

                                        {selectedStock.signals?.includes('revenue') && (
                                            <div className="signal-item">
                                                <div className="signal-icon revenue">üí∞</div>
                                                <div className="signal-content">
                                                    <h4>Revenue Growth: {selectedStock.revenue_growth_yoy ? `+${selectedStock.revenue_growth_yoy}% YoY` : 'Strong'}</h4>
                                                    <p>Revenue is {selectedStock.revenue_accelerating ? 'accelerating' : 'growing'} year-over-year{selectedStock.revenue_accelerating ? ', faster than the previous quarter' : ''}.</p>
                                                </div>
                                            </div>
                                        )}

                                        {selectedStock.signals?.includes('volume') && (
                                            <div className="signal-item">
                                                <div className="signal-icon volume">üìä</div>
                                                <div className="signal-content">
                                                    <h4>Volume Spike: {selectedStock.volume_spike_pct?.toFixed(0)}% of Average</h4>
                                                    <p>Trading volume is elevated above the 20-day average, indicating heightened market attention.</p>
                                                </div>
                                            </div>
                                        )}

                                        {selectedStock.signals?.includes('options') && (
                                            <div className="signal-item">
                                                <div className="signal-icon options">üéØ</div>
                                                <div className="signal-content">
                                                    <h4>Options Flow: {selectedStock.options_flow_description}</h4>
                                                    <p>
                                                        {selectedStock.unusual_options_activity 
                                                            ? 'Unusual options activity detected. Smart money appears to be positioning.'
                                                            : `Call/Put ratio: ${selectedStock.options_volume_ratio?.toFixed(2) || 'N/A'}`}
                                                    </p>
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
